<!--
.. weat documentation master file, created by
   sphinx-quickstart on Mon Dec  7 19:13:05 2020.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.
-->

```eval_rst
.. toctree::
   :maxdepth: 2
   :caption: Contents:
```

# [Weat](https://weatinc.com/): a meal delivery app toolkit
Welcome to Weat, a new meal delivery service that brings the restaurant experience to your doorstep.  
Weat is in its in initial engineering phases. This API is a prototype, from which later versions of Weat will evolve. We appreciate any feedback and support!  
   
## Overview
Using Python3, this API implements a mock backend [database](#Database), as well as prototypes for Weat's [frontend](#Frontend) [backend](#Backend) services. As of now, the database is run off of local machines for complete control of server-client interactions. In later versions, Weat will likely use [Firestore](https://cloud.google.com/firestore/) and other Google Cloud services, such as authentication.

## Database
### Objects
Weat's Database stores four main objects:  
1. **[Customer](#Customer)**: Information about users, including name, address, and other required data.
2. **[Restaurant](#Restaurant)**: Representations of all the restaurants delivering meals on Weat.
3. **[Item](#Item)**: Anything available for order is stored as an item.
4. **[Order](#Order)**: Information about customer purchases.  

Each of these objects are stored as standard Python dictionaries. The database keeps track of each object with a unique ID, which is assigned at the object's creation. Methods for adding, removing, and retrieving each are generally included in Database.py as `add[Object Name]()`, `remove[Object Name]()`, and `get[Object Name]()` (for example, `addRestaurant()`. See the objects' documentations below for more details.  

### Instantiation
The database can be instantiated in three different ways by passing `None`, the string `'empty'`, or a custom dictionary into its constructor. If `None` is passed into the database constructor **(recommended)**, a mock database is instantiated from createDatabase.py. If the string `'empty'` is passed in, the database is instantiated with no data. Otherwise, a dictionary with custom data can be used to create the database, although it must follow this format: (with all keys as strings):
- customers: a list of dictionaries representing customers
- restaurants: a list of dictionaries representing restaurants
- items: a list of dictionaries representing items
- orders: a list of dictionaries representing orders
- ids: a list of unique ids
- logins: a mapping of mock usernames to mock passwords, which are automatically generated in createDatabase.py


### Customer
Each customer is stored as a dictionary with the following key-value pairs, where all keys are strings:
- name: a string holding the customer's name
- address: a string holding the customer's address
- id: an integer id, generated by the database  

Calling `addCustomer(name, address)` adds a customer to the database, where it is given a unique ID. This ID can then be passed in to `removeCustomer(id)` and `getCustomer(id)` to remove and retrieve from the database, respectively.

### Restaurant
Restaurants are stored as a dictionaries with the following key-value pairs, where all keys are strings:
- name: a string holding the restaurants's name
- address: a string holding the restaurants's address
- cuisine: a string tagging the restaurant by the type of food offered, such as "Italian" or "comfort"
- id: an integer id, generated by the database  

Calling `addRestaurant(name, address, cuisine)` adds a restaurant to the database, where it is given a unique ID. This ID can then be passed in to `removeRestaurant(id)` and `getRestaurant(id)` to remove and retrieve from the database, respectively.

### Item
Items are stored as dictionaries with the following key-value pairs, where all keys are strings:
- restId: an integer representing the id of the restaurant from which this item can be ordered
- name: a string holding the items's name
- price: a float holding the items's price (in USD)
- id: an integer id, generated by the database  

Calling `addItem(restId, name, price)` adds an item to the database, where it is given a unique ID. This ID can then be passed in to `removeItem(id)` and `getItem(id)` to remove and retrieve from the database, respectively.

### Order
Items are stored as dictionaries with the following key-value pairs, where all keys are strings:
- custId: an integer representing the id of the customer purchasing this order
- restId: an integer representing the id of the restaurant preparing the item in this order
- itemId: the integer id of the item being purchased.
- timestamp: an integer recording when this order was created
- id: an integer id, generated by the database  

Calling `addOrder(custId, restId, itemId, timestamp)` adds an order to the database, where it is given a unique ID. This ID can then be passed in to `removeOrder(id)` and `getOrder(id)` to remove and retrieve from the database, respectively.

## Frontend
Check back soon for documentation on Weat's frontend!

## Backend
Weat's backend uses [Flask](https://flask.palletsprojects.com/en/1.1.x/) to handle client requests and return JSON data from the [database](#Database). Backend actions are currently distinguished by pointing the browser to a specific URL, and providing supplementary parameters. Logging in with a valid username and password yields a key, which is required for all other actions. The currently supported actions are:  
- [Login](#Login)
- [Get by ID](#Get-by-ID) 
- [Get restaurants](#Get-restaurants)
- [Get items](#Get-items)
- [Get customer orders](#Get-customer-orders)  
  
### login
Use the path `/login?username=[USERNAME]&password=[PASSWORD]` to simulate logging in to Weat. Two parameters are required:
- username: a valid username in the database
- password: a valid password in the database that corresponds to the provided username  
If a valid username and password pair is provided, a unique key and user ID are returned. The provided key is necessary for access to all of the other actions.  

### Get by ID
To get any object from the database by its ID, navigate to `/getById?id=[ID]&key=[KEY]`, where `[ID]` is the object's ID and `[KEY]` is a valid key returned from a successful [login](#Login). If the key is accepted and the provided ID exists, database object is returned in JSON format. 

### Get restaurants
To get all restaurants in the database, navigate to `/getRestaurants?key=[KEY]`, where `[KEY]` is a valid key returned from a successful [login](#Login). If the key is accepted, all restaurants in the database are returned in JSON format. 

### Get items
To get all items in the database, navigate to `/getItems?key=[KEY]`, where `[KEY]` is a valid key returned from a successful [login](#Login). If the key is accepted, all items in the database are returned in JSON format. 

### Get customer orders
To get any customer's orders, navigate to `/getCustomerOrders?id=[ID]&key=[KEY]`, where `[ID]` is the ID of the *customer*, and `[KEY]` is a valid key returned from a successful [login](#Login). If the key is accepted, that customer's orders are returned in JSON format. 
  
```eval_rst
* :ref:`genindex`
* :ref:`modindex`
* :ref:`search`
```
